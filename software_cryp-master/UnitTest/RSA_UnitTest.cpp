#include "stdafx.h"

#include <iostream>
#include <sstream>
#include <string>
#include "CppUnitTest.h"

#include "../RSA/RSA_Decryption.h"
#include "../RSA/RSA_Encryption.h"
#include "../RSA/RSA_Generate.h"
#include "../bigint/unsigned_bigint.h"

using namespace Microsoft::VisualStudio::CppUnitTestFramework;

namespace UnitTest {

	TEST_CLASS(RSA_test) {
public:
	TEST_METHOD(RSA_Enc) {
		RSA::PublicKey<2048 / 64> public_key;
		
		public_key.N = unsigned_bigint<2048 / 64>("0x8FB058B1A364D2CCEFC93B366C7AE262E2C548B1483B3E55186094E7D1200050905334B8DDD00FAEE71F897D000B188C1D14F823C3B52B3402F112B31EF272976BA62BB1E4214BAB373661E07BA2A618BCA4501FBB48BD25F7035357B27E36C6E750D3B61C67063E431D31CAE3F7D2971E426B9812380D5CAFC022E95EE7292E9397A8D091E875A6553DCB3950F4ED20B17B3F91FFDD159DD9DD2BC8AC3FC77468472FC4B84CA67A48E97DEFC4EC3C5C00C59022C9A7A603565C04EC2A2A07F44F0008ADCF93DB55E0B9AB69E343A4FC7FC9E81EDC3D44C1F97684FEF77FBA137D9EC61D2AED91CC2A983CB49A936DCD770ED092B05BEDD5D960C9E8CE139DC3");
		public_key.e = unsigned_bigint<2048 / 64>("0x10001");
		public_key.flash();
		std::vector<unsigned_bigint<2048 / 64>> message = {
			unsigned_bigint<2048 / 64>("0xF1ECB731FBC6F3C7D5CC03C1F07FC86081C0914E01D3801DF0F4B868FD45BF943507918F2EB9C57C13039DFB57FD668F6EBF408D4B328CB214D3D258D65FEC4172D317AD738B1DA8412AC7C2457163A9140572C73B4598BD6F406A271A4A66D14CA7A7F9E1F1744C5A33838B23576375A55C9D93109907189332F5F0A0CF6D1C0CB3503DDA3F0BBF332644D27CFD7D0E88BD67758AAFEC807F24A2D1F2900A5754BBB5DD3AC45AE01608CED918F94F209AF5FF96D297DAD0E1E8C9A26BB07E34545C8287CBDD38BDD6431792389411B32645058F6679E5DEA8D0FB8982F9D88FF214412B59F4BE5B0C7951B96C8361C29E0CB1F384CC0DE9C15C96FF475EE42"),
			unsigned_bigint<2048 / 64>("0x2AF7BCF04CD0A471B048676CCDF3823ABD878C5521E3C1A06EDCC33519DEE570942E4BC01141549324974BFAD0DC0DFF77CE5AE45F24CECCBA008D9B16625F88567615FFE69EFDBD5A50D8C60B867EFEFB41265395DEF9165B1DB48C2F9277AD31DDE17413C67B674C9D71917181846E317586E7CA1755B2170E4D06AE134D8769CC93C7884000160B7DD85718659D4D77C7558CE9451F98E7BF0C617C959C9DD0754FF0C6D4D9AA4C99E66F1F46C05379ACF0C337C0A831D365344D070A6DC6CCAA37F8F8C9C349F650697C89EA2EDA082F2790EFEFCD63ACDB1B4F1B925303A860FC887C5D79026F332E9B85541DCAE63848B9515CFECC514B97648088DE6A"),
			unsigned_bigint<2048 / 64>("0x5E9065AB4A84F6DB1E92A008DE0ECB83D4726741C866826E88383A24BAD469B380EE364FBD9BD9C9DBB2799233F0D6D0BBB8414E1DB8079544A40C80DFA960EA7570D26830D81853977ABF9E8841F6F6BC908CF6359486646494D5A9F0F4CE9F2D3799B9982B38497D647024B55A3F2D517F91B0DB0D595AA56A82D6F9C0CA98D6FB67BAC67C18D2537D87BDC4057BA740FDEDF94A791C65F016F8BB7FECA9AD7CBF1ED58247591E366F305DACD5902994CB0CC369E12E1D8AA90A05569F52B3198B7BF41DF8DB69D2D5065EC06F362D76FB90DC3D9E85085CEF1244798C0C446B62AF5C812D53883311A2127D38F14F6BD2E75B439F3AE10E2E73EA089C8637"),
			unsigned_bigint<2048 / 64>("0x823B6DF011795EB8819CA85154722B4CBC1EEA677609E16193B475802CC1224CACDBE451B5822FF4604CAED892871015E11F69A5C25EB791BD3408B019161C82E9F258524A9389CC1E69FC338A24FAAA0C34ACBB6C959DB313589EE50256D1C1665797F02BA84F84CC01F5CDC506055F99A427937F36EC343E60B0E589106C80B048CE725205FC8AA0C6E01B1E1713B8B1EBCA5A020BA70A02363662612EC7C28DB7940EAA70A42F3CADE98ACD7CA43BA3CE4E02F24C920CD4A5619F551271D81EA0BD6EC88F5A1F6E596B5882A6B25E094B16D587817F503FB5CD077CFE5C87542BCA1BE20B809C3F05516749F755A622733E0795BDB556C54C061B04C20DD"),
			unsigned_bigint<2048 / 64>("0x6181BAB45F954A4C29BDF97346C66965593BC2464AE47CC4AD6A1A1E27C6ACE465506767FDAFBF80EC4C70A18B838DB13F43C062B1FFC8631675741F6CB12EC93EDD58B017A6F4AD6D286C5CAE3D9B3121FD12CF6A2695EB598459C16763637B7B00D38B6FC77D20A58A59817C67CFD8C8C8D0CD32C3793113C39EBA8D36BC58D36641F52E7B59FE02A998628FCC5C2015701C71B72BA9DF48FBC47CFAAFB9E4E9E575C734EC4A2DC43C46CBC77E5FE5A7E9C9928716947D92434208018EBCA73142EC37597AED3415F65EA5C1C421E802B678B67B223CFA53E18971CC3DF7F944C40E491A1ACC203EAA897A5D7570909A228C6A5BF122E6781826A40FCA2C3B")
		};
		std::vector<unsigned_bigint<2048 / 64>> secret = {
			unsigned_bigint<2048 / 64>("0x5D894C7A1A87BE955EB054AAF1140E2811B7B89DF0A25A8176316124B4AFE1A02E970568F2314DE882E3A0EAAF049F84201F203311CCB2FFC186D5F053FBA4434297E8C4948DDF6500EF0ABC827D0B6CE23CB68ACFD21CA55C35F9DC96156E33EAE8CDBE2265DDDEAA3BB030D128A5FB1E64FF82E782A418F8EFE414DB596558CB636EFEDADB1A28E5F0B9DE2A2D88F6ACF0332FBCD0BF963E7C340AD965456A8FBC22D98C855A995D78E3298D4FDA04CF8C52B6B73FC6FC2374272037A5F0886D3C1A35632C02863CB23139CBCC9D9D9AEEF0371953DE60DEB79F330E0032A423E8FB1DB494C44D9D6CDBDC73CDEE275ADD05A84AFA6733ED21C8BCC743F79C"),
			unsigned_bigint<2048 / 64>("0x4F1F6C410FAB52CCEA884A7ACF0467F6524DC1B66E7EEA9518724EE9A26EFE50EF005909734401AE414580207A3A6884FEA79987679E9FB708C5BCEECEEAD4DBF4715C8EC1312C27C375A6CE1971137839394A8A293AD4556DB4310B86FF0D204510D8BA438FC9C7BFDFDEB9E64E61EBEA8782D6E5F826CA1627D54702C4D466A992DF8C77496AD55877F5EDDB7AC5F39D7F473BBF4E1196857D6E947DB63C4D1C0CF45C3B076405BC7C18348A6CD6B4AA5BD1E37789DBC2FFA731E6C83EFD2412A725EC9BCDCDF384D7EF41743FF820C69A6A5181936E8B84D52AD4B08D8B4B9898CBE93686A0265A82C75FFFD34FB72F35384C20FCB6252C83FDD3C6BBE3FB"),
			unsigned_bigint<2048 / 64>("0x738BF40F046A56A817C5E4CA532DBE7E3893B88BEFB2FAD443FB587DB88C47DD4684CC8D1A14A19C028BB90B7047B1655A3216866472E86CEDB8BF0A42A740F891F24A38628735A6BDA0FE054B40EADEE90C98CB97CF49D4DBFD5CA790634358464CF8A0BDC1E9994EA75A487390DE3B1365705ACC7C36C6B5FE311FAFA670B831E6672F03E2E0708EE2EBCEAD7B3FC4EA306EA32E754EF0F89F759E3D431B059EAA076DEEE754A673252B858273BE478D75F0BE3A0D45C6D327868FCA74D8C99817FCFFFC0297C585BEBF4A76B49BE8EA5E4AC8103469F4B1D51E4475527F9818C3D26B7D1EF8643F07169993D46C908AC1F5E3A37E0F3BF37FB3D2C86078A2"),
			unsigned_bigint<2048 / 64>("0xFC67B07619B04F493AD84EDDC1BC62D06500F26909DA6F81894BDFBAE5512DD95737D7AFFA7F910D45D185798ACC20ABE27459897B654C44F32CB44A3803DF41BDE508D1748CC89031F8F3AAD0B51C19AEEA261A76E952743805282F424395E739FA2A86211252B243DF209216041562A420609330360AC56142F3F5795AD68653E49376129726FDF433ED71A8F8F822D05B1ECA5F2038511FFB1C62631F02C566C694A3FDB2B29FF853D983155BB79116E3C8D23B485DBD9F86900CA6EAF39F62D9385BB774FDD8B8868A645B56EB1DA7E1BB3C8F052862496A723EADD1EA9FED98B1D944A63D5FF2649A082E87543237509570BC8A524B591286892B42A99"),
			unsigned_bigint<2048 / 64>("0x2ED30800625AB1417AFE3E5774A7D6DB88615BBD1E18D0B9C56E0EA7B55D30105EC942F134D216C8D4704D1B5349D5FE76A11A9920F86448AFA14CCFBCC7414C19AEDF64CFA14B75AC8E2356387A007A350B5ED2A3B08DCAFA8373842173CFD41F1780F8891308A06706144AC72EAC0B50F0F23EB69850FBC323D8A20D8D01E5FE9954C51F176C9A221414161F6281F7627FDA40300A58A6F370E1F4CB7D885BDC0B27E3CCB67DAFF0A188C48CE1BAFDDDCE15F58DB931D8AF6FD5E4A528E465B03577B67D8B0E10F55686DFE7E9F3694D342B9A1F6D17E2ADF1B1E94627A1807B53CD8C4DF789DE0497134F89C312D00BD2544BFCD9D6ACB49C0EB0E267331E")
		};
		for (int i = 0; i < std::min(message.size(), secret.size()); i++) {
			unsigned_bigint<2048 / 64> s;
			RSA::EncryptionMessage(public_key, message[i], s);
			Assert::IsTrue(s == secret[i]);
		}
	}
	TEST_METHOD(RSA_Dec) {
		RSA::PrivateKey<2048 / 64> private_key;
		private_key.N = unsigned_bigint<2048 / 64>("0x8FB058B1A364D2CCEFC93B366C7AE262E2C548B1483B3E55186094E7D1200050905334B8DDD00FAEE71F897D000B188C1D14F823C3B52B3402F112B31EF272976BA62BB1E4214BAB373661E07BA2A618BCA4501FBB48BD25F7035357B27E36C6E750D3B61C67063E431D31CAE3F7D2971E426B9812380D5CAFC022E95EE7292E9397A8D091E875A6553DCB3950F4ED20B17B3F91FFDD159DD9DD2BC8AC3FC77468472FC4B84CA67A48E97DEFC4EC3C5C00C59022C9A7A603565C04EC2A2A07F44F0008ADCF93DB55E0B9AB69E343A4FC7FC9E81EDC3D44C1F97684FEF77FBA137D9EC61D2AED91CC2A983CB49A936DCD770ED092B05BEDD5D960C9E8CE139DC3");
		private_key.d = unsigned_bigint<2048 / 64>("0x1B26D79BB9A473B1061EA071C84DF0397F60883BF7CA3A1D1A5E25C5285F43AFF595C380AB69858D275F6E3B90A6881CF1E1E481DD997E70759DD84AC0AE4FB90D3E794344388673F41AF2A3D8B90369E93BA3685B9B8322896AB774FAE59EB43741AEBFDADE1CEFE6FEBD49F989FAE15376799E62D2F4B36F027F9659B894AF4DD27808525AAEA68A78F53DD7308005DA13B084C44E57A378BB0A00591785C7B936FA6C8724CDB1B93B7D134E148D8042F83DE29565CCD916FCD4DCB6F854373BC2F57B34B10E21C76738CF86A5D12330A963DD12E2C9FEFB873C1A2AF8A06935E3E8CCBDFFE45909EFEA3E80AC6EE419D561BC5B92D975DED1357FA5A4321");
		private_key.p = unsigned_bigint<2048 / 64 / 2>("0x966EC773986F8B0DD14B7627103CC71100F7A6CA7392624E9A15ABD3D52D67D6D4F25D25B1376BC3572262F2ADB6BDEEEB2C030C2AF586C809CCDCF6EBFE03555A4170D9FE25856F1156743233EB9D993834038C9B97424DDE3A0DBE4D94B66C0791C0EFA1F195E5C09335F15F2B8FCB13D9DD1D5177FE3F3B457522E03BC69B");
		private_key.q = unsigned_bigint<2048 / 64 / 2>("0xF48607D679BDB10524B37EEF99104F460DEB3BAA02F76F77EC76143A3BC9A1C7EEA51E9EFEC9634309FAE715FF3B89E71F0408E545385C1CCA73CA28985CBCDB7BCF6F8391031D48EDA16464043C6A6D2A38327E994AC9872CF7D7CD6AAFE7D54E16F843E2AFDCF4ABFC027EDF3B399DA8CC869B21B7D79819A922269BBCE3F9");
		private_key.dp = unsigned_bigint<2048 / 64 / 2>("0x84028CC6B503556C77B917E329CD9C0720E93295C09BB9E72E324C4A256DA60D116BEA2FD47744FAF3B0FA51E9FD4E69A63846285C5E7FBB755630A602EC32B2A8F47A7AE21ABD207D7F7792429BC5FE1A2312E645F793B8CF85F45F86A734FA521E26C8633DA4842CDD425E215D11DF6CF9279FBDC965F4C927A7A6464E4E77");
		private_key.dq = unsigned_bigint<2048 / 64 / 2>("0xC20416F3F664ACB0880E64097849989CDD2E6888DD11B740503EE08DD422885B3ADF890C5EDD2C056545CF5584CE98FCE97F2A0FC07C9799C0895F3E16A67EB327E9CF7174FE239E59EE54D98702E8EEF530E1DFD181A5A5BBE86B32721460BEBED73AE5A25827D97B1CDA5E1081CD956AF9DD53F9CD05238A38C9001952271");
		private_key.qInv = unsigned_bigint<2048 / 64 / 2>("0x8F26012CCCBA206C604478A25234002E74D9A49A62E748A1AD6A9599EE316B5ED8D156AA1C48B9654DC94E88E913D6C93935F544C5C7ABC962B188BD1ED5AE4E0C0EE624168F56DBC47B54E21785F80CC862A52BAC54725003AF589D11031967E4CBA318CC2CB62B595D7F0971CEF7BBADBDF4B396B22B912315E1DCEB3A5AB5");
		private_key.flash();
		std::vector<unsigned_bigint<2048 / 64>> message = {
			unsigned_bigint<2048 / 64>("0xF1ECB731FBC6F3C7D5CC03C1F07FC86081C0914E01D3801DF0F4B868FD45BF943507918F2EB9C57C13039DFB57FD668F6EBF408D4B328CB214D3D258D65FEC4172D317AD738B1DA8412AC7C2457163A9140572C73B4598BD6F406A271A4A66D14CA7A7F9E1F1744C5A33838B23576375A55C9D93109907189332F5F0A0CF6D1C0CB3503DDA3F0BBF332644D27CFD7D0E88BD67758AAFEC807F24A2D1F2900A5754BBB5DD3AC45AE01608CED918F94F209AF5FF96D297DAD0E1E8C9A26BB07E34545C8287CBDD38BDD6431792389411B32645058F6679E5DEA8D0FB8982F9D88FF214412B59F4BE5B0C7951B96C8361C29E0CB1F384CC0DE9C15C96FF475EE42"),
			unsigned_bigint<2048 / 64>("0x2AF7BCF04CD0A471B048676CCDF3823ABD878C5521E3C1A06EDCC33519DEE570942E4BC01141549324974BFAD0DC0DFF77CE5AE45F24CECCBA008D9B16625F88567615FFE69EFDBD5A50D8C60B867EFEFB41265395DEF9165B1DB48C2F9277AD31DDE17413C67B674C9D71917181846E317586E7CA1755B2170E4D06AE134D8769CC93C7884000160B7DD85718659D4D77C7558CE9451F98E7BF0C617C959C9DD0754FF0C6D4D9AA4C99E66F1F46C05379ACF0C337C0A831D365344D070A6DC6CCAA37F8F8C9C349F650697C89EA2EDA082F2790EFEFCD63ACDB1B4F1B925303A860FC887C5D79026F332E9B85541DCAE63848B9515CFECC514B97648088DE6A"),
			unsigned_bigint<2048 / 64>("0x5E9065AB4A84F6DB1E92A008DE0ECB83D4726741C866826E88383A24BAD469B380EE364FBD9BD9C9DBB2799233F0D6D0BBB8414E1DB8079544A40C80DFA960EA7570D26830D81853977ABF9E8841F6F6BC908CF6359486646494D5A9F0F4CE9F2D3799B9982B38497D647024B55A3F2D517F91B0DB0D595AA56A82D6F9C0CA98D6FB67BAC67C18D2537D87BDC4057BA740FDEDF94A791C65F016F8BB7FECA9AD7CBF1ED58247591E366F305DACD5902994CB0CC369E12E1D8AA90A05569F52B3198B7BF41DF8DB69D2D5065EC06F362D76FB90DC3D9E85085CEF1244798C0C446B62AF5C812D53883311A2127D38F14F6BD2E75B439F3AE10E2E73EA089C8637"),
			unsigned_bigint<2048 / 64>("0x823B6DF011795EB8819CA85154722B4CBC1EEA677609E16193B475802CC1224CACDBE451B5822FF4604CAED892871015E11F69A5C25EB791BD3408B019161C82E9F258524A9389CC1E69FC338A24FAAA0C34ACBB6C959DB313589EE50256D1C1665797F02BA84F84CC01F5CDC506055F99A427937F36EC343E60B0E589106C80B048CE725205FC8AA0C6E01B1E1713B8B1EBCA5A020BA70A02363662612EC7C28DB7940EAA70A42F3CADE98ACD7CA43BA3CE4E02F24C920CD4A5619F551271D81EA0BD6EC88F5A1F6E596B5882A6B25E094B16D587817F503FB5CD077CFE5C87542BCA1BE20B809C3F05516749F755A622733E0795BDB556C54C061B04C20DD"),
			unsigned_bigint<2048 / 64>("0x6181BAB45F954A4C29BDF97346C66965593BC2464AE47CC4AD6A1A1E27C6ACE465506767FDAFBF80EC4C70A18B838DB13F43C062B1FFC8631675741F6CB12EC93EDD58B017A6F4AD6D286C5CAE3D9B3121FD12CF6A2695EB598459C16763637B7B00D38B6FC77D20A58A59817C67CFD8C8C8D0CD32C3793113C39EBA8D36BC58D36641F52E7B59FE02A998628FCC5C2015701C71B72BA9DF48FBC47CFAAFB9E4E9E575C734EC4A2DC43C46CBC77E5FE5A7E9C9928716947D92434208018EBCA73142EC37597AED3415F65EA5C1C421E802B678B67B223CFA53E18971CC3DF7F944C40E491A1ACC203EAA897A5D7570909A228C6A5BF122E6781826A40FCA2C3B")
		};
		std::vector<unsigned_bigint<2048 / 64>> secret = {
			unsigned_bigint<2048 / 64>("0x5D894C7A1A87BE955EB054AAF1140E2811B7B89DF0A25A8176316124B4AFE1A02E970568F2314DE882E3A0EAAF049F84201F203311CCB2FFC186D5F053FBA4434297E8C4948DDF6500EF0ABC827D0B6CE23CB68ACFD21CA55C35F9DC96156E33EAE8CDBE2265DDDEAA3BB030D128A5FB1E64FF82E782A418F8EFE414DB596558CB636EFEDADB1A28E5F0B9DE2A2D88F6ACF0332FBCD0BF963E7C340AD965456A8FBC22D98C855A995D78E3298D4FDA04CF8C52B6B73FC6FC2374272037A5F0886D3C1A35632C02863CB23139CBCC9D9D9AEEF0371953DE60DEB79F330E0032A423E8FB1DB494C44D9D6CDBDC73CDEE275ADD05A84AFA6733ED21C8BCC743F79C"),
			unsigned_bigint<2048 / 64>("0x4F1F6C410FAB52CCEA884A7ACF0467F6524DC1B66E7EEA9518724EE9A26EFE50EF005909734401AE414580207A3A6884FEA79987679E9FB708C5BCEECEEAD4DBF4715C8EC1312C27C375A6CE1971137839394A8A293AD4556DB4310B86FF0D204510D8BA438FC9C7BFDFDEB9E64E61EBEA8782D6E5F826CA1627D54702C4D466A992DF8C77496AD55877F5EDDB7AC5F39D7F473BBF4E1196857D6E947DB63C4D1C0CF45C3B076405BC7C18348A6CD6B4AA5BD1E37789DBC2FFA731E6C83EFD2412A725EC9BCDCDF384D7EF41743FF820C69A6A5181936E8B84D52AD4B08D8B4B9898CBE93686A0265A82C75FFFD34FB72F35384C20FCB6252C83FDD3C6BBE3FB"),
			unsigned_bigint<2048 / 64>("0x738BF40F046A56A817C5E4CA532DBE7E3893B88BEFB2FAD443FB587DB88C47DD4684CC8D1A14A19C028BB90B7047B1655A3216866472E86CEDB8BF0A42A740F891F24A38628735A6BDA0FE054B40EADEE90C98CB97CF49D4DBFD5CA790634358464CF8A0BDC1E9994EA75A487390DE3B1365705ACC7C36C6B5FE311FAFA670B831E6672F03E2E0708EE2EBCEAD7B3FC4EA306EA32E754EF0F89F759E3D431B059EAA076DEEE754A673252B858273BE478D75F0BE3A0D45C6D327868FCA74D8C99817FCFFFC0297C585BEBF4A76B49BE8EA5E4AC8103469F4B1D51E4475527F9818C3D26B7D1EF8643F07169993D46C908AC1F5E3A37E0F3BF37FB3D2C86078A2"),
			unsigned_bigint<2048 / 64>("0xFC67B07619B04F493AD84EDDC1BC62D06500F26909DA6F81894BDFBAE5512DD95737D7AFFA7F910D45D185798ACC20ABE27459897B654C44F32CB44A3803DF41BDE508D1748CC89031F8F3AAD0B51C19AEEA261A76E952743805282F424395E739FA2A86211252B243DF209216041562A420609330360AC56142F3F5795AD68653E49376129726FDF433ED71A8F8F822D05B1ECA5F2038511FFB1C62631F02C566C694A3FDB2B29FF853D983155BB79116E3C8D23B485DBD9F86900CA6EAF39F62D9385BB774FDD8B8868A645B56EB1DA7E1BB3C8F052862496A723EADD1EA9FED98B1D944A63D5FF2649A082E87543237509570BC8A524B591286892B42A99"),
			unsigned_bigint<2048 / 64>("0x2ED30800625AB1417AFE3E5774A7D6DB88615BBD1E18D0B9C56E0EA7B55D30105EC942F134D216C8D4704D1B5349D5FE76A11A9920F86448AFA14CCFBCC7414C19AEDF64CFA14B75AC8E2356387A007A350B5ED2A3B08DCAFA8373842173CFD41F1780F8891308A06706144AC72EAC0B50F0F23EB69850FBC323D8A20D8D01E5FE9954C51F176C9A221414161F6281F7627FDA40300A58A6F370E1F4CB7D885BDC0B27E3CCB67DAFF0A188C48CE1BAFDDDCE15F58DB931D8AF6FD5E4A528E465B03577B67D8B0E10F55686DFE7E9F3694D342B9A1F6D17E2ADF1B1E94627A1807B53CD8C4DF789DE0497134F89C312D00BD2544BFCD9D6ACB49C0EB0E267331E")
		};
		for (int i = 0; i < std::min(message.size(), secret.size()); i++) {
			unsigned_bigint<2048 / 64> m;
			RSA::DecryptionMessage(private_key, secret[i], m);
			Assert::IsTrue(m == message[i]);
		}
	}
	TEST_METHOD(RSA_Enc_Dec_rand) {
		for (int i = 0; i < 2; i++) {
			RSA::PublicKey<2048 / 64> public_key;
			RSA::PrivateKey<2048 / 64> private_key;
			RSA::Generate(public_key, private_key, 1);
			for (int j = 0; j < 128; j++) {
				unsigned_bigint<2048 / 64> message, secret, decryption_message;
				message = unsigned_bigint<2048 / 64>::rand();
				if (message > public_key.N) message >>= 1;
				RSA::EncryptionMessage(public_key, message, secret);
				RSA::DecryptionMessage(private_key, secret, decryption_message);
				Assert::IsTrue(message == decryption_message);
			}
		}
	}
	};

}  // namespace UnitTest